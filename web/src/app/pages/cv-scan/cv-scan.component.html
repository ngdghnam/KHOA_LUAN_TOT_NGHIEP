<div class="cv-upload-container">
  <mat-card class="upload-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>cloud_upload</mat-icon>
        Upload CV của bạn
      </mat-card-title>
      <mat-card-subtitle> Hỗ trợ file PDF, DOC, DOCX (Tối đa 5MB) </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <!-- Drop Zone -->
      <div
        class="drop-zone"
        [class.dragging]="isDragging"
        [class.has-file]="selectedFile"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
      >
        <div *ngIf="!selectedFile" class="drop-zone-content">
          <mat-icon class="upload-icon">cloud_upload</mat-icon>
          <p class="drop-text">Kéo thả file vào đây</p>
          <p class="or-text">hoặc</p>

          <input
            type="file"
            #fileInput
            [accept]="acceptedFormats.join(',')"
            (change)="onFileSelected($event)"
            style="display: none"
          />

          <button mat-raised-button color="primary" (click)="fileInput.click()">
            <mat-icon>folder_open</mat-icon>
            Chọn file
          </button>
        </div>

        <!-- File Preview -->
        <div *ngIf="selectedFile" class="file-preview">
          <div class="file-info">
            <mat-icon class="file-icon" [color]="'primary'">
              {{ getFileIcon(selectedFile.name) }}
            </mat-icon>
            <div class="file-details">
              <p class="file-name">{{ selectedFile.name }}</p>
              <p class="file-size">{{ getFileSize(selectedFile.size) }}</p>
            </div>
            <button mat-icon-button color="warn" (click)="removeFile()" [disabled]="uploading">
              <mat-icon>close</mat-icon>
            </button>
          </div>

          <!-- Upload Progress -->
          <mat-progress-bar
            *ngIf="uploading"
            mode="determinate"
            [value]="uploadProgress"
            class="upload-progress"
          >
          </mat-progress-bar>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="actions" *ngIf="selectedFile && !uploading">
        <button mat-raised-button color="primary" (click)="uploadFile()" class="upload-btn">
          <mat-icon>upload</mat-icon>
          Upload CV
        </button>

        <button mat-stroked-button (click)="removeFile()">
          <mat-icon>refresh</mat-icon>
          Chọn file khác
        </button>
      </div>

      <!-- Upload Status -->
      <div class="upload-status" *ngIf="uploading">
        <mat-spinner diameter="30" class="spinner"></mat-spinner>
        <span>Đang upload... {{ uploadProgress }}%</span>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Information Card -->
  <mat-card class="info-card">
    <mat-card-content>
      <h3>
        <mat-icon>info</mat-icon>
        Lưu ý khi upload CV
      </h3>
      <ul>
        <li>Đảm bảo CV của bạn được cập nhật thông tin mới nhất</li>
        <li>Sử dụng định dạng file chuẩn (PDF được khuyến nghị)</li>
        <li>Tên file nên rõ ràng, dễ nhận biết</li>
        <li>Kiểm tra kỹ trước khi upload</li>
      </ul>
    </mat-card-content>
  </mat-card>
</div>
